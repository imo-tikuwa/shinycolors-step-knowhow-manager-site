import{_ as V}from"./CommonHeader.3dKHoZZE.js";import L from"./multiselect.esm.b8RRiNK-.js";import{_ as B,d as E,v as _,z as a,A as l,E as F,r as K,F as S,G as A,o as N,t as p,H as C,I as D,J as y,B as T,y as $,m as G,x as M,K as P}from"./entry.5rKgAf99.js";import U from"./column.esm.XL19bpn2.js";import H from"./row.esm.kga04tqq.js";import I from"./columngroup.esm.ia6X84v9.js";import O from"./datatable.esm.KK6L9Ksb.js";import{u as R,d as u}from"./index.m6Zhnn5G.js";import"./splitbutton.esm.MxPUfuTz.js";import"./index.esm.IYKhIMEJ.js";import"./tieredmenu.esm.gQmWDd1L.js";import"./index.esm.6xdOGTLj.js";import"./dropdown.esm.kdC2MCfU.js";import"./virtualscroller.esm.UJAEeBN5.js";import"./inputswitch.esm.tib-gFHO.js";import"./tabpanel.esm.ec6bZfVw.js";import"./tabview.esm.rdHh-VOC.js";import"./index.esm.dHM1AmfE.js";import"./index.esm.6AlRwMoK.js";import"./sidebar.esm.iXgPPKMH.js";import"./vue.f36acd1f.XHDwu-gl.js";import"./index.esm.r205Bm14.js";import"./paginator.esm.AxK4tTfc.js";import"./index.esm.xCvhYSKr.js";import"./inputnumber.esm.hsTEOkSO.js";import"./index.esm.7-2Ssbfp.js";import"./index.esm.dyQkP6uB.js";import"./inputtext.esm.fQqr2na0.js";import"./index.esm.tJsEbDc_.js";import"./index.esm.bYHsqVfZ.js";import"./index.esm.j8uoya8n.js";const j=E({setup(){const t=F(),c=R(),{$constants:h}=G(),b=K({name:{value:null,matchMode:S.IN}}),k=A([]),w=K(h.eachCharacterPageDefaultDisplayKnowhows),m=K(h.eachCharacterPageDefaultDisplayKnowhows);return N(()=>{const n=u(c.unserializedData);h.characters.forEach(i=>{const r=u(DEFAULT_CHARACTER_KNOWHOW);r.name=i;const d=n.filter(e=>{var o;return((o=e.name)==null?void 0:o.code)===i.code});if(d.length>0){let e=[];d.forEach(o=>{o.knowhows.forEach(s=>{s.knowhow&&s.level&&e.push(u(s))})}),e=e.sort((o,s)=>o.knowhow.code!==s.knowhow.code?o.knowhow.code.localeCompare(s.knowhow.code):s.level.code-o.level.code),r.knowhows=e.reduce((o,s)=>{const v=o[o.length-1];return(!v||v.knowhow.code!==s.knowhow.code)&&o.push(s),o},[])}k.push(r)})}),{filters:b,characterKnowhows:k,displayTargetKnowhows:w,tempDisplayTargetKnowhows:m,displayKnowhow:(n,i)=>{let r=n.find(d=>{var e;return((e=d.knowhow)==null?void 0:e.code)===i.code});return r?r.level.name:null},applyDisplayTargetKnowhows:()=>{m.value.length>=25?t.require({header:"確認",message:"表示対象とするノウハウが多い場合、表示に時間が掛かる場合があります",acceptLabel:"OK",rejectLabel:"キャンセル",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:()=>{w.value=u(m.value)}}):w.value=u(m.value)}}}}),z={class:"container"},W=M("div",{class:"mb-3 font-bold"},"キャラクター",-1),q=M("span",{class:"p-column-title white-space-nowrap mr-3"},"表示するノウハウ",-1);function J(t,c,h,b,k,w){const m=V,g=L,f=P,n=U,i=H,r=I,d=O;return p(),_("div",z,[a(m),a(d,{value:t.characterKnowhows,class:"p-datatable-sm mb-4",dataKey:"id",showGridlines:"",sortMode:"multiple",multiSortMeta:[{field:"id",order:1}],responsiveLayout:"scroll",filters:t.filters,"onUpdate:filters":c[1]||(c[1]=e=>t.filters=e),filterDisplay:"menu"},{default:l(()=>[a(r,{type:"header"},{default:l(()=>[a(i,null,{default:l(()=>[a(n,{header:"キャラクター",rowspan:2,sortable:!0,sortField:"name.code",filterField:"name",showFilterMatchModes:!1,filterMenuStyle:{width:"18rem"},class:"white-space-nowrap",style:{width:"130px"}},{filter:l(({filterModel:e})=>[W,a(g,{modelValue:e.value,"onUpdate:modelValue":o=>e.value=o,options:t.$constants.characters,optionLabel:"name",class:"p-column-filter",display:"chip"},null,8,["modelValue","onUpdate:modelValue","options"])]),filterclear:l(({filterCallback:e})=>[a(f,{label:"クリア",type:"button",icon:"pi pi-times",iconPos:"right",class:"p-button-sm p-button-secondary",onClick:o=>e()},null,8,["onClick"])]),filterapply:l(({filterCallback:e})=>[a(f,{label:"適用",type:"button",icon:"pi pi-check",iconPos:"right",class:"p-button-sm p-button-success",onClick:o=>e()},null,8,["onClick"])]),_:1}),a(n,{colspan:t.$constants.flattenKnowhows.length},{header:l(e=>[q,a(g,{modelValue:t.tempDisplayTargetKnowhows,"onUpdate:modelValue":c[0]||(c[0]=o=>t.tempDisplayTargetKnowhows=o),options:t.$constants.knowhows,optionLabel:"name",optionGroupLabel:"name",optionGroupChildren:"items",filter:!0,display:"chip",showToggleAll:!1,class:"mr-3",style:{"max-width":"200px"}},null,8,["modelValue","options"]),a(f,{label:"反映",type:"button",class:"p-button-sm p-button-success white-space-nowrap",onClick:t.applyDisplayTargetKnowhows},null,8,["onClick"])]),_:1},8,["colspan"])]),_:1}),a(i,null,{default:l(()=>[t.displayTargetKnowhows.length?(p(!0),_(C,{key:0},D(t.displayTargetKnowhows,e=>(p(),y(n,{field:e.code,header:e.name,key:e.code,class:"white-space-nowrap"},null,8,["field","header"]))),128)):(p(),y(n,{key:1}))]),_:1})]),_:1}),a(n,{field:"name",header:"キャラクター"},{body:l(e=>{var o;return[T($((o=e.data.name)==null?void 0:o.name),1)]}),_:1}),t.displayTargetKnowhows.length?(p(!0),_(C,{key:0},D(t.displayTargetKnowhows,(e,o)=>(p(),y(n,{field:"knowhow"+o,header:e.name,class:"text-center"},{body:l(s=>[T($(t.displayKnowhow(s.data.knowhows,e)),1)]),_:2},1032,["field","header"]))),256)):(p(),y(n,{key:1}))]),_:1},8,["value","filters"])])}const Te=B(j,[["render",J]]);export{Te as default};
