import{_ as $}from"./CommonHeader.W4K2OZlU.js";import B from"./multiselect.esm.Rp09Hn9X.js";import{d as M,E as V,r as K,F as L,G as S,o as N,m as G,_ as P,v as C,z as s,A as l,t as p,H as D,I as A,J as g,B as F,y as E,x as T,K as U}from"./entry.c9B8gHe0.js";import H from"./column.esm.4PEupTrc.js";import I from"./row.esm._phVU4jn.js";import O from"./columngroup.esm.9osQNWEK.js";import R from"./datatable.esm.s7M2JWsk.js";import{u as j,d as h}from"./index.GIUG_p-p.js";import"./splitbutton.esm.xI3QhGMW.js";import"./index.esm.eibiTJYJ.js";import"./tieredmenu.esm._hFLnHWf.js";import"./index.esm.01QaUlIB.js";import"./dropdown.esm.6PLotOjS.js";import"./virtualscroller.esm.cO6TxxIM.js";import"./inputswitch.esm.hN6L8d9i.js";import"./tabpanel.esm.Pg-3bTyl.js";import"./tabview.esm.jHpQTNqf.js";import"./index.esm.HRrDqgD0.js";import"./index.esm.ICZY5Ahg.js";import"./sidebar.esm.9CYWimRp.js";import"./index.esm.XIm0lXDE.js";import"./paginator.esm.Wb4Jqtvr.js";import"./index.esm.nprlkMtS.js";import"./inputnumber.esm.Ux7hGpGB.js";import"./index.esm.q_foOtpI.js";import"./index.esm.2JtWcvlM.js";import"./inputtext.esm.kGQ4ltZZ.js";import"./index.esm.j5yYZnCo.js";import"./index.esm.0Xwp-B4i.js";import"./index.esm.8Aryx1mA.js";const z=M({setup(){const t=V(),c=j(),{$constants:w}=G(),b=K({name:{value:null,matchMode:L.IN}}),_=S([]),f=K(w.eachCharacterPageDefaultDisplayKnowhows),u=K(w.eachCharacterPageDefaultDisplayKnowhows),y={name:null,knowhows:[]};return N(()=>{const m=h(c.unserializedData);w.characters.forEach(d=>{const i=h(y);i.name=d;const e=m.filter(o=>{var a;return((a=o.name)==null?void 0:a.code)===d.code});if(e.length>0){let o=[];e.forEach(a=>{a.knowhows.forEach(n=>{n.knowhow&&n.level&&o.push(h(n))})}),o=o.sort((a,n)=>a.knowhow.code!==n.knowhow.code?a.knowhow.code.localeCompare(n.knowhow.code):n.level.code-a.level.code),i.knowhows=o.reduce((a,n)=>{const v=a[a.length-1];return(!v||v.knowhow.code!==n.knowhow.code)&&a.push(n),a},[])}_.push(i)})}),{filters:b,characterKnowhows:_,displayTargetKnowhows:f,tempDisplayTargetKnowhows:u,displayKnowhow:(m,d)=>{let i=m.find(e=>{var o;return((o=e.knowhow)==null?void 0:o.code)===d.code});return i?i.level.name:null},applyDisplayTargetKnowhows:()=>{u.value.length>=25?t.require({header:"確認",message:"表示対象とするノウハウが多い場合、表示に時間が掛かる場合があります",acceptLabel:"OK",rejectLabel:"キャンセル",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:()=>{f.value=h(u.value)}}):f.value=h(u.value)}}}}),W={class:"container"},q=T("div",{class:"mb-3 font-bold"},"キャラクター",-1),J=T("span",{class:"p-column-title white-space-nowrap mr-3"},"表示するノウハウ",-1);function Q(t,c,w,b,_,f){const u=$,y=B,k=U,r=H,m=I,d=O,i=R;return p(),C("div",W,[s(u),s(i,{value:t.characterKnowhows,class:"p-datatable-sm mb-4",dataKey:"id",showGridlines:"",sortMode:"multiple",multiSortMeta:[{field:"id",order:1}],responsiveLayout:"scroll",filters:t.filters,"onUpdate:filters":c[1]||(c[1]=e=>t.filters=e),filterDisplay:"menu"},{default:l(()=>[s(d,{type:"header"},{default:l(()=>[s(m,null,{default:l(()=>[s(r,{header:"キャラクター",rowspan:2,sortable:!0,sortField:"name.code",filterField:"name",showFilterMatchModes:!1,filterMenuStyle:{width:"18rem"},class:"white-space-nowrap",style:{width:"130px"}},{filter:l(({filterModel:e})=>[q,s(y,{modelValue:e.value,"onUpdate:modelValue":o=>e.value=o,options:t.$constants.characters,optionLabel:"name",class:"p-column-filter",display:"chip"},null,8,["modelValue","onUpdate:modelValue","options"])]),filterclear:l(({filterCallback:e})=>[s(k,{label:"クリア",type:"button",icon:"pi pi-times",iconPos:"right",class:"p-button-sm p-button-secondary",onClick:o=>e()},null,8,["onClick"])]),filterapply:l(({filterCallback:e})=>[s(k,{label:"適用",type:"button",icon:"pi pi-check",iconPos:"right",class:"p-button-sm p-button-success",onClick:o=>e()},null,8,["onClick"])]),_:1}),s(r,{colspan:t.$constants.flattenKnowhows.length},{header:l(e=>[J,s(y,{modelValue:t.tempDisplayTargetKnowhows,"onUpdate:modelValue":c[0]||(c[0]=o=>t.tempDisplayTargetKnowhows=o),options:t.$constants.knowhows,optionLabel:"name",optionGroupLabel:"name",optionGroupChildren:"items",filter:!0,display:"chip",showToggleAll:!1,class:"mr-3",style:{"max-width":"200px"}},null,8,["modelValue","options"]),s(k,{label:"反映",type:"button",class:"p-button-sm p-button-success white-space-nowrap",onClick:t.applyDisplayTargetKnowhows},null,8,["onClick"])]),_:1},8,["colspan"])]),_:1}),s(m,null,{default:l(()=>[t.displayTargetKnowhows.length?(p(!0),C(D,{key:0},A(t.displayTargetKnowhows,e=>(p(),g(r,{field:e.code,header:e.name,key:e.code,class:"white-space-nowrap"},null,8,["field","header"]))),128)):(p(),g(r,{key:1}))]),_:1})]),_:1}),s(r,{field:"name",header:"キャラクター"},{body:l(e=>{var o;return[F(E((o=e.data.name)==null?void 0:o.name),1)]}),_:1}),t.displayTargetKnowhows.length?(p(!0),C(D,{key:0},A(t.displayTargetKnowhows,(e,o)=>(p(),g(r,{field:"knowhow"+o,header:e.name,class:"text-center"},{body:l(a=>[F(E(t.displayKnowhow(a.data.knowhows,e)),1)]),_:2},1032,["field","header"]))),256)):(p(),g(r,{key:1}))]),_:1},8,["value","filters"])])}const Ae=P(z,[["render",Q]]);export{Ae as default};
